!function i(a,c,s){function l(e,t){if(!c[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(d)return d(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[e]={exports:{}};a[e][0].call(o.exports,function(t){return l(a[e][1][t]||t)},o,o.exports,i,a,c,s)}return c[e].exports}for(var d="function"==typeof require&&require,t=0;t<s.length;t++)l(s[t]);return l}({1:[function(r,o,t){(function(t){"use strict";var e,n=(e=r("./libs/blocky"))&&e.__esModule?e:{default:e};o.exports=n.default,t.self&&t.self instanceof Object&&t.self===t.self.self&&(t.self.Blocky=n.default)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./libs/blocky":2}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var Z=t("./stdlib");function b(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x=30;t("../styles/blocky.scss");function k(t){var e=document.createElement("div");return e.classList.add(t),e}function u(t,e){return Array.prototype.find.call(t.children,function(t){return!!new RegExp("^".concat(w,"$"),"i").test(t.nodeName)&&(!(0,Z.isset)(e)||e===t.getAttribute(O.container))})}function f(t){for(var e=t.getDOM(),n=0,r=0,o=t.getChild();o;o=o.getNext()){var i=o.getDOM();n+=i.clientWidth,r+=i.clientHeight}et._expressionHole===t.getType()&&(e.style.minWidth=n),e.style.minHeight=r;var a=u(e);if(a){var c=m(Array.prototype.reduce.call(a.children,function(t,e){var n=getComputedStyle(e);return[Math.max(t[0],e.clientWidth+parseFloat(n.marginRight||0)+parseFloat(n.marginLeft||0)),t[1]+(e.clientHeight+parseFloat(n.marginTop||0)+parseFloat(n.marginBottom||0))]},[0,0]),2),s=c[0],l=c[1];a.style.minWidth=s,a.style.minHeight=l}for(var d=t;d;){var p=d.getParent();if(p){f(p);break}d=d.getLast()}}function _(t){var e=t.clientX,n=t.clientY,r=t.touches,o=m(r=void 0===r?[]:r,1)[0],i=(o=void 0===o?{}:o).clientX,a=void 0===i?e:i,c=o.clientY;return[a,void 0===c?n:c]}function v(g){function n(t){if(g.getEnabled()){t.stopPropagation(),g.unlink("last"),g.unlink("parent");var s=null,e=m(_(t),2),n=e[0],r=e[1],o=k.getBoundingClientRect(),i=o.x,a=o.y,l=o.width,d=o.height,p=n-i,u=r-a,f=Array.prototype.filter.call(k.parentNode.querySelectorAll("blocky"),function(t){if(t===k||!(0,Z.isset)(t.__blocky)||k.contains(t))return!1;var e=t.getAttribute(O.type);return v.includes(e)}),c=function(){return[].concat(M.dragMove).concat(M.dragEnd).forEach(function(t){return A.removeEvent(t)})},h=function(){Array.prototype.forEach.call(document.querySelectorAll("".concat(w,"[").concat(O.linkedType,"]")),function(t){t.removeAttribute(O.linkedType)})},y=function(t){var e=m(_(t),2),n=e[0],r=e[1],o={x:n-p,y:r-u,width:l,height:d};k.style.top=o.y,k.style.left=o.x;var i=f.reduce(function(t,e){var n=function t(e,n,r){var o=e.__blocky,i=r.__blocky;if(!nt.isBlocky(o))throw new Error("Not a blocky DOM");if(!nt.isBlocky(i))throw new Error("Not a target blocky DOM");var a=o.getType(),c=i.getType(),s=r.getBoundingClientRect(),l=n.x,d=n.y,p=(n.width,n.height),u=s.x,f=s.y,h=s.width,y=s.height,b={target:{type:c,blocky:i,dom:r,rect:s}};if(a===et.stackTop){if(c!==et.stackMiddle&&c!==et.composite&&c!==et.stackBottom)return console.warn("Unsupported target blocky type: ".concat(c)),{distance:1/0};var g=f-(d+p),k=u-l;return tt({},b,{anchor:[u,f],linkType:{self:"next",target:"last"},distance:(0,Z.dist)(k,g)})}if(a===et.stackMiddle){if(c===et.stackTop){var v=f+y-d,m=u-l;return tt({},b,{anchor:[u,f+y],linkType:{self:"last",target:"next"},distance:(0,Z.dist)(m,v)})}if(c===et.stackMiddle||c===et.composite){var x=f+y-d,_=f-(d+p),w=u-l,O=(0,Z.dist)(w,x),T=(0,Z.dist)(w,_);return tt({},b,O<T?{anchor:[u,f+y],linkType:{self:"last",target:"next"},distance:O}:{anchor:[u,f],linkType:{self:"next",target:"last"},distance:T})}if(c!==et.stackBottom)return console.warn("Unsupported target blocky type: ".concat(c)),{distance:1/0};var E=f-(d+p),C=u-l;return tt({},b,{anchor:[u,f],linkType:{self:"next",target:"last"},distance:(0,Z.dist)(C,E)})}if(a===et.stackBottom){if(c!==et.stackTop&&c!==et.stackMiddle&&c!==et.composite)return console.warn("Unsupported target blocky type: ".concat(c)),{distance:1/0};var j=f+y-d,M=u-l;return tt({},b,{anchor:[u,f+y],linkType:{self:"last",target:"next"},distance:(0,Z.dist)(M,j)})}if(a===et.composite){if(c===et.stackTop){var A=f+y-d,P=u-l;return tt({},b,{anchor:[u,f+y],linkType:{self:"last",target:"next"},distance:(0,Z.dist)(P,A)})}if(c===et.stackMiddle||c===et.composite){var B=f+y-d,D=f-(d+p),S=u-l,N=(0,Z.dist)(S,B),H=(0,Z.dist)(S,D);return tt({},b,N<H?{anchor:[u,f+y],linkType:{self:"last",target:"next"},distance:N}:{anchor:[u,f],linkType:{self:"next",target:"last"},distance:H})}if(c!==et.stackBottom)return console.warn("Unsupported target blocky type: ".concat(c)),{distance:1/0};var L=f-(d+p),U=u-l;return tt({},b,{anchor:[u,f],linkType:{self:"next",target:"last"},distance:(0,Z.dist)(U,L)})}if(a===et.expression){if(c!==et._expressionHole)return console.warn("Unsupported target blocky type: ".concat(c)),{distance:1/0};var z=u-l,I=f-d;return tt({},b,{anchor:[u,f],linkType:{self:"parent",target:"child"},distance:(0,Z.dist)(z,I)})}if(a!==et.contained)return console.warn("Unsupported blocky type: ".concat(a)),{distance:1/0};if(c===et.composite){var F=i.getChild();if(F){for(var W={distance:1/0},q={distance:1/0},R=F;R;R=R.getNext()){var Y=t(e,n,R.getDOM());Y.distance<q.distance&&(q=Y)}return W}var X=u+h-l,$=f-d;return tt({},b,{anchor:[u+h,f],linkType:{self:"parent",target:"child"},distance:(0,Z.dist)(X,$)})}if(c!==et.contained)return console.warn("Unsupported target blocky type: ".concat(c)),{distance:1/0};var G=f+y-d,J=f-(d+p),K=u-l,Q=(0,Z.dist)(K,G),V=(0,Z.dist)(K,J);return tt({},b,Q<V?{anchor:[u,f+y],linkType:{self:"last",target:"next"},distance:Q}:{anchor:[u,f],linkType:{self:"next",target:"last"},distance:V})}(k,o,e);return t.distance<n.distance?t:n},{distance:1/0});if(x<i.distance)s&&(h(),s=null);else{var a=i.target,c=i.linkType;s=i,h(),a.dom.setAttribute(O.linkedType,c.target)}},b=function(){if(s){var t=s.target,e=s.linkType;g.link(e.self,t.blocky)}h(),c()};c(),M.dragMove.forEach(function(t){return A.addEvent(t,y)}),M.dragEnd.forEach(function(t){return A.addEvent(t,b)}),k.parentNode.appendChild(k)}}var t,k=g.__dom,e=g.__type,v=et.stackTop===(t=e)?[et.stackMiddle,et.stackBottom,et.composite]:et.stackMiddle===t?[et.stackTop,et.stackMiddle,et.stackBottom,et.composite]:et.stackBottom===t?[et.stackTop,et.stackMiddle,et.composite]:et.expression===t?[et._expressionHole]:et.composite===t?[et.stackTop,et.stackMiddle,et.stackBottom,et.composite]:et.contained===t?[et.composite,et.contained]:[];M.dragStart.forEach(function(t){var e=g.__events[t];(0,Z.isfunc)(e)&&k.removeEventListener(t,e),k.addEventListener(t,n),g.__events[t]=n})}var o,i,w="blocky",O=(0,Z.objMap)({type:"type",linkedType:"linkedType",container:"container",content:"content",shape:"shape"},function(t){return"data-".concat(t)}),T="lastIndent",E="parentBump",C="nextBump",j="childPool",et={stackTop:"stackTop",stackMiddle:"stackMiddle",stackBottom:"stackBottom",composite:"composite",contained:"contained",expression:"expression",_expressionHole:"expressionHole"},M={dragStart:["touchstart","mousedown"],dragEnd:["touchend","mouseup","mouseleave"],dragMove:["touchmove","mousemove"]},A=(o={},{addEvent:function(t,e){i(t),document.body.addEventListener(t,e),o[t]=e},removeEvent:i=function(t){var e=o[t];(0,Z.isfunc)(e)&&(document.body.removeEventListener(t,e),delete o[t])}}),nt=function t(){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),g(this,"destroy",function(){var t=o.__dom;t.parentNode.removeChild(t)}),g(this,"getId",function(){return o.__id}),g(this,"setId",function(t){return o.__id=t}),g(this,"getType",function(){return o.__type}),g(this,"getDOM",function(){return o.__dom}),g(this,"getContent",function(){return o.__content.children}),g(this,"setContent",function(){for(var e=o.__content;e.firstChild;)e.removeChild(e.firstChild);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t){t instanceof Element?e.appendChild(t):e.appendChild(document.createTextNode(t))})}),g(this,"getParent",function(){return o.__links.parent}),g(this,"getChild",function(){return o.__links.child}),g(this,"getLast",function(){return o.__links.last}),g(this,"getNext",function(){return o.__links.next}),g(this,"setEnabled",function(t){return o.__enabled=!!t}),g(this,"getEnabled",function(){return o.__enabled});for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i,a,c,s,l=n[0],d=(l=void 0===l?{}:l).id,p=void 0===d?Date.now():d,u=l.type,f=l.content,h=l.contents,y=void 0===h?(0,Z.isset)(f)?[f]:[]:h;if(!Object.keys(et).map(function(t){return et[t]}).includes(u))throw new Error("Invalid blocky type: ".concat(u));this.setId(p),this.__type=u,this.__links={},this.__events={},this.__dom=(i=this,a=document.createElement(w),c=document.createElement("div"),s=i.getType(),c.setAttribute(O.shape,""),a.setAttribute(O.type,s),a.__blocky=i,a.style.top=0,a.style.left=0,a.style.display="inline-block",a.style.overflow="visible",a.style.userSelect="none",et.stackTop===s?c.appendChild(k(C)):et.stackMiddle===s?(c.appendChild(k(T)),c.appendChild(k(C))):et.stackBottom===s?c.appendChild(k(T)):et.composite===s?(c.appendChild(k(T)),c.appendChild(k(C)),c.appendChild(k(j))):et.contained===s?(c.appendChild(k(T)),c.appendChild(k(C))):et.expression!==s&&et._expressionHole!==s||c.appendChild(k(E)),a.appendChild(c),a),this.__content=document.createElement("div"),this.__content.setAttribute(O.content,""),this.__dom.appendChild(this.__content),/^_/.test(Object.keys(et).find(function(t){return u===et[t]}))||v(this),document.body.appendChild(this.getDOM()),this.setContent.apply(this,b(y)),this.setEnabled(!0)};nt.isBlocky=function(t){return t instanceof nt},nt.createExpressionHoleDOM=function(){return new nt({type:et._expressionHole}).getDOM()},nt.getAttractDistance=function(){return x},nt.setAttractDistance=function(t){var e=parseFloat(t);if(isNaN(e))throw new Error("Invalid attract distance: ".concat(t));return x=e},nt.TYPE=Object.keys(et).filter(function(t){return!/^_/.test(t)}).reduce(function(t,e){return tt({},t,g({},e,et[e]))},{}),Object.freeze(nt.TYPE),nt.prototype.link=function(t,e){var n=this.getDOM(),r=e.getDOM();if("parent"===t){var o=this.getParent();o&&(this.unlink(t),e.link("parent",o)),e.link("child",this)}else if("last"===t){var i=this.getLast();i&&(this.unlink(t),e.link("last",i)),e.link("next",this)}else{if("next"!==t&&"child"!==t)throw new Error("Not support link type: ".concat(t));var a=u(n,t);if(a||((a=document.createElement(w)).setAttribute(O.container,t),n.appendChild(a)),"next"===t){var c=this.getNext();c&&(this.unlink("next"),e.link("next",c)),e.__links.last=this}else if("child"===t){var s=this.getChild();s&&(this.unlink("child"),e.link("child",s)),e.__links.parent=this}try{var l=m(Array.prototype.reduce.call(a.children,function(t,e){return[Math.max(t[0],e.clientWidth),t[1]+e.clientHeight]},[r.clientWidth,r.clientHeight]),2),d=l[0],p=l[1];a.style.minWidth=d,a.style.minHeight=p,a.appendChild(r)}catch(t){console.warn("appendChild failed",t.message),console.warn(" `- this",this),console.warn(" `- target",e),console.warn(" `- container",a),console.warn(" `- stack",t.stack)}r.style.top=0,r.style.left=0,this.__links[t]=e,f(this)}return this},nt.prototype.unlink=function(t){var e=this.getDOM(),n=this.__links[t];if(!n)return this;if("next"===t||"child"===t)return"next"===t?n.unlink("last"):"child"===t&&n.unlink("parent"),this;if("last"!==t&&"parent"!==t)throw new Error("Unsupport link type: ".concat(t));var r=n.getDOM();"last"===t?n.__links.next=null:"parent"===t&&(n.__links.child=null);var o=function t(e){var n=e.parentNode;if(n instanceof Window||n instanceof Document)return document.body;if(new RegExp("^".concat(w,"$"),"i").test(n.nodeName))return t(n);var r=getComputedStyle(n).position;return r&&"static"!==r?n:t(n)}(r.parentNode),i=o.getBoundingClientRect(),a=getComputedStyle(o),c=e.getBoundingClientRect();return e.style.top=c.y-i.y+parseFloat(a.marginTop||0),e.style.left=c.x-i.x+parseFloat(a.marginLeft||0),o.appendChild(e),this.__links[t]=null,f(n),this};var a=nt;n.default=a},{"../styles/blocky.scss":6,"./stdlib":3}],3:[function(t,e,n){"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(n,"__esModule",{value:!0}),n.objMap=n.dist=n.isfunc=n.isarray=n.isstr=n.isset=void 0;n.isset=function(t){return void 0!==t};n.isstr=function(t){return"string"==typeof t};n.isarray=function(t){return Array.isArray(t)};n.isfunc=function(t){return"function"==typeof t};n.dist=function(t,e){return Math.sqrt(t*t+e*e)};n.objMap=function(n,r,t){var o=2<arguments.length&&void 0!==t?t:n;return Object.keys(n).reduce(function(t,e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,a({},e,r.bind(o)(n[e],e,n)))},{})}},{}],4:[function(t,e,n){e.exports=function(t,e){var n=e||document;if(n.createStyleSheet){var r=n.createStyleSheet();return r.cssText=t,r.ownerNode}var o=n.getElementsByTagName("head")[0],i=n.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(n.createTextNode(t)),o.appendChild(i),i},e.exports.byUrl=function(t){if(document.createStyleSheet)return document.createStyleSheet(t).ownerNode;var e=document.getElementsByTagName("head")[0],n=document.createElement("link");return n.rel="stylesheet",n.href=t,e.appendChild(n),n}},{}],5:[function(t,e,n){e.exports=t("cssify")},{cssify:4}],6:[function(t,e,n){e.exports=t("sassify")('blocky[data-type] {   --highlight-color: #f00;   --shape-color: #fcc;   --empty-color: #333;   --exist-color: var(--shape-color);   --width: 1.5vmin;   --height: 1.5vmin;   --offset: 1vmin;   --padding: 1px;   position: absolute;   padding: 10px;   min-width: 0;   min-height: 0;   box-sizing: border-box;   z-index: 0; }  blocky > [data-content] {   position: relative;   display: flex;   align-items: center;   z-index: 10; }  blocky > [data-shape] {   position: absolute;   top: 0;   right: 0;   bottom: 0;   left: 0;   background-color: var(--shape-color);   pointer-events: none;   z-index: 5; }   blocky > [data-shape] > * {     position: absolute; }     blocky > [data-shape] > *.lastIndent {       top: 0;       left: var(--offset);       border-color: var(--empty-color) transparent;       border-style: solid;       border-width: var(--height) var(--width);       border-bottom-width: 0; }     blocky > [data-shape] > *.nextBump {       top: 100%;       left: var(--offset);       border-color: var(--exist-color) transparent;       border-style: solid;       border-width: var(--height) var(--width);       border-bottom-width: 0; }     blocky > [data-shape] > *.parentBump {       top: var(--offset);       right: 100%;       border-color: transparent var(--exist-color);       border-style: solid;       border-width: var(--width) var(--height);       border-left-width: 0; }     blocky > [data-shape] > *.childPool {       top: 0;       bottom: 0;       left: 100%;       width: var(--offset);       border-width: var(--width) 0;       border-style: solid;       border-color: var(--exist-color); }  blocky[data-linkedType="last"]::before {   content: \'\';   position: absolute;   top: 0;   right: 0;   left: 0;   transform: translateY(-50%);   height: 1vmin;   background-color: var(--highlight-color);   opacity: .5;   z-index: 7; }  blocky[data-linkedType="next"]::after {   content: \'\';   position: absolute;   right: 0;   bottom: 0;   left: 0;   transform: translateY(50%);   height: 1vmin;   background-color: var(--highlight-color);   opacity: .5;   z-index: 7; }  blocky[data-type="stackTop"] {   --shape-color: #fcc; }   blocky[data-type="stackTop"] > blocky[data-container="next"] {     top: 100%;     left: 0; }  blocky[data-type="stackMiddle"] {   --shape-color: #ffc; }   blocky[data-type="stackMiddle"] > blocky[data-container="next"] {     top: 100%;     left: 0; }  blocky[data-type="stackBottom"] {   --shape-color: #cfc; }  blocky[data-type="composite"] {   --shape-color: #cff; }   blocky[data-type="composite"][data-linkedType="child"]::after {     content: \'\';     position: absolute;     top: 0;     right: 0;     bottom: 0;     transform: translateX(50%);     width: 1vmin;     background-color: var(--highlight-color);     opacity: .5;     z-index: 3; }   blocky[data-type="composite"] > blocky[data-container="child"] {     top: 0;     left: 100%; }   blocky[data-type="composite"] > blocky[data-container="next"] {     top: 100%;     left: 0; }  blocky[data-type="expression"] {   --shape-color: #ccf; }  blocky[data-type="expressionHole"] {   --shape-color: #666;   position: relative;   margin-right: var(--offset);   margin-left: calc(var(--height) + var(--offset));   display: inline-block; }   blocky[data-type="expressionHole"][data-linkedType="child"] {     --shape-color: var(--highlight-color); }   blocky[data-type="expressionHole"] > blocky[data-container="child"] {     top: 0;     left: 0;     padding: var(--padding);     z-index: 20; }  blocky[data-type="contained"] {   --shape-color: #fcf; }   blocky[data-type="contained"] > blocky[data-container="next"] {     top: 100%;     left: 0; }  blocky[data-container] {   position: absolute; } ')},{sassify:5}]},{},[1]);
